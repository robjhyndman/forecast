<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Neural Network Time Series Forecasts — nnetar • forecast</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Neural Network Time Series Forecasts — nnetar"><meta name="description" content="Feed-forward neural networks with a single hidden layer and lagged inputs
for forecasting univariate time series."><meta property="og:description" content="Feed-forward neural networks with a single hidden layer and lagged inputs
for forecasting univariate time series."><meta property="og:image" content="https://pkg.robjhyndman.com/forecast/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">forecast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">8.24.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/web/packages/forecast/vignettes/JSS2008.pdf">JSS paper</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change Log</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/forecast/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Neural Network Time Series Forecasts</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/forecast/blob/master/R/nnetar.R" class="external-link"><code>R/nnetar.R</code></a></small>
      <div class="d-none name"><code>nnetar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Feed-forward neural networks with a single hidden layer and lagged inputs
for forecasting univariate time series.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nnetar</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  P <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repeats <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  xreg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale.inputs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num.cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  x <span class="op">=</span> <span class="va">y</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a numeric vector or univariate time series of class <code>ts</code></p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Embedding dimension for non-seasonal time series. Number of
non-seasonal lags used as inputs. For non-seasonal time series, the default
is the optimal number of lags (according to the AIC) for a linear AR(p)
model. For seasonal time series, the same method is used but applied to
seasonally adjusted data (from an stl decomposition). If set to zero to
indicate that no non-seasonal lags should be included, then P must be at
least 1 and a model with only seasonal lags will be fit.</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Number of seasonal lags used as inputs.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Number of nodes in the hidden layer. Default is half of the
number of input nodes (including external regressors, if given) plus 1.</p></dd>


<dt id="arg-repeats">repeats<a class="anchor" aria-label="anchor" href="#arg-repeats"></a></dt>
<dd><p>Number of networks to fit with different random starting
weights. These are then averaged when producing forecasts.</p></dd>


<dt id="arg-xreg">xreg<a class="anchor" aria-label="anchor" href="#arg-xreg"></a></dt>
<dd><p>Optionally, a numerical vector or matrix of external regressors,
which must have the same number of rows as <code>y</code>. It should not be a data frame.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Box-Cox transformation parameter. If <code>lambda = "auto"</code>,
then a transformation is automatically selected using <code>BoxCox.lambda</code>.
The transformation is ignored if NULL. Otherwise,
data transformed before model is estimated.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Output from a previous call to <code>nnetar</code>. If model is
passed, this same model is fitted to <code>y</code> without re-estimating any
parameters.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>Optional vector specifying a subset of observations to be used
in the fit. Can be an integer index vector or a logical vector the same
length as <code>y</code>. All observations are used by default.</p></dd>


<dt id="arg-scale-inputs">scale.inputs<a class="anchor" aria-label="anchor" href="#arg-scale-inputs"></a></dt>
<dd><p>If <code>TRUE</code>, inputs are scaled by subtracting the column
means and dividing by their respective standard deviations. If <code>lambda</code>
is not <code>NULL</code>, scaling is applied after Box-Cox transformation.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>If <code>TRUE</code>, then the specification search is done in parallel
via <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parallel::parLapply()</a></code>. This can give a significant speedup on
multicore machines.</p></dd>


<dt id="arg-num-cores">num.cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>Allows the user to specify the amount of parallel processes
to be used if <code>parallel = TRUE</code>. If <code>NULL</code>, then the number of logical cores
is automatically detected and all available cores are used.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Deprecated. Included for backwards compatibility.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet::nnet()</a></code> for <code>nnetar</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>nnetar</code>.</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the
results.</p>
<p>The generic accessor functions <code>fitted.values</code> and <code>residuals</code>
extract useful features of the value returned by <code>nnetar</code>.</p>
<dl><dt>model</dt>
<dd><p>A list containing information about the fitted model</p></dd>

<dt>method</dt>
<dd><p>The name of the forecasting method as a character string</p></dd>

<dt>x</dt>
<dd><p>The original time series.</p></dd>

<dt>xreg</dt>
<dd><p>The external regressors used in fitting (if given).</p></dd>

<dt>residuals</dt>
<dd><p>Residuals from the fitted model. That is x minus fitted values.</p></dd>

<dt>fitted</dt>
<dd><p>Fitted values (one-step forecasts)</p></dd>

<dt>...</dt>
<dd><p>Other arguments</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A feed-forward neural network is fitted with lagged values of <code>y</code> as inputs
and a single hidden layer with <code>size</code> nodes. The inputs are for lags 1 to
<code>p</code>, and lags <code>m</code> to <code>mP</code> where <code>m = frequency(y)</code>. If <code>xreg</code> is provided,
its columns are also used as inputs. If there are missing values in <code>y</code> or
<code>xreg</code>, the corresponding rows (and any others which depend on them as lags)
are omitted from the fit. A total of <code>repeats</code> networks are fitted, each
with random starting weights. These are then averaged when computing
forecasts. The network is trained for one-step forecasting. Multi-step
forecasts are computed recursively.</p>
<p>For non-seasonal data, the fitted model is denoted as an NNAR(p,k) model,
where k is the number of hidden nodes. This is analogous to an AR(p) model
but with nonlinear functions. For seasonal data, the fitted model is called
an NNAR(p,P,k)[m] model, which is analogous to an ARIMA(p,0,0)(P,0,0)[m]
model but with nonlinear functions.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rob J Hyndman and Gabriel Caceres</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">nnetar</span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fcast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fcast</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nnetar-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Arguments can be passed to nnet()</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">nnetar</span><span class="op">(</span><span class="va">lynx</span>, decay <span class="op">=</span> <span class="fl">0.5</span>, maxit <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nnetar-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model to first 100 years of lynx data</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">nnetar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">lynx</span>, end <span class="op">=</span> <span class="fl">1920</span><span class="op">)</span>, decay <span class="op">=</span> <span class="fl">0.5</span>, maxit <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, h <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lynx</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nnetar-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Apply fitted model to later data, including all optional arguments</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">nnetar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">lynx</span>, start <span class="op">=</span> <span class="fl">1921</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://robjhyndman.com" class="external-link">Rob Hyndman</a>, George Athanasopoulos, <a href="https://github.com/cbergmeir" class="external-link">Christoph Bergmeir</a>, <a href="https://github.com/gabrielcaceres" class="external-link">Gabriel Caceres</a>, Leanne Chhay, Kirill Kuroptev, <a href="https://github.com/m-muecke" class="external-link">Maximilian Mücke</a>, <a href="https://github.com/mitchelloharawild" class="external-link">Mitchell O’Hara-Wild</a>, <a href="http://fpetropoulos.eu" class="external-link">Fotios Petropoulos</a>, <a href="https://github.com/slavarazbash" class="external-link">Slava Razbash</a>, <a href="http://earo.me" class="external-link">Earo Wang</a>, Farah Yasmeen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>


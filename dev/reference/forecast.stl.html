<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Forecasting using stl objects — forecast.stl • forecast</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Forecasting using stl objects — forecast.stl" />
<meta property="og:description" content="Forecasts of STL objects are obtained by applying a non-seasonal forecasting
method to the seasonally adjusted data and re-seasonalizing using the last
year of the seasonal component." />
<meta property="og:image" content="/logo.png" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">forecast</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">8.15.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://cran.r-project.org/web/packages/forecast/vignettes/JSS2008.pdf">JSS paper</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robjhyndman/forecast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Forecasting using stl objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/robjhyndman/forecast/blob/master/R/mstl.R'><code>R/mstl.R</code></a></small>
    <div class="hidden name"><code>forecast.stl.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Forecasts of STL objects are obtained by applying a non-seasonal forecasting
method to the seasonally adjusted data and re-seasonalizing using the last
year of the seasonal component.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for stl</span>
<span class='fu'><a href='forecast.html'>forecast</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ets"</span>, <span class='st'>"arima"</span>, <span class='st'>"naive"</span>, <span class='st'>"rwdrift"</span><span class='op'>)</span>,
  etsmodel <span class='op'>=</span> <span class='st'>"ZZN"</span>,
  forecastfunction <span class='op'>=</span> <span class='cn'>NULL</span>,
  h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/time.html'>frequency</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>$</span><span class='va'>time.series</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span>,
  level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>95</span><span class='op'>)</span>,
  fan <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lambda <span class='op'>=</span> <span class='cn'>NULL</span>,
  biasadj <span class='op'>=</span> <span class='cn'>NULL</span>,
  xreg <span class='op'>=</span> <span class='cn'>NULL</span>,
  newxreg <span class='op'>=</span> <span class='cn'>NULL</span>,
  allow.multiplicative.trend <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>stlm</span><span class='op'>(</span>
  <span class='va'>y</span>,
  s.window <span class='op'>=</span> <span class='fl'>7</span> <span class='op'>+</span> <span class='fl'>4</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>,
  robust <span class='op'>=</span> <span class='cn'>FALSE</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ets"</span>, <span class='st'>"arima"</span><span class='op'>)</span>,
  modelfunction <span class='op'>=</span> <span class='cn'>NULL</span>,
  model <span class='op'>=</span> <span class='cn'>NULL</span>,
  etsmodel <span class='op'>=</span> <span class='st'>"ZZN"</span>,
  lambda <span class='op'>=</span> <span class='cn'>NULL</span>,
  biasadj <span class='op'>=</span> <span class='cn'>FALSE</span>,
  xreg <span class='op'>=</span> <span class='cn'>NULL</span>,
  allow.multiplicative.trend <span class='op'>=</span> <span class='cn'>FALSE</span>,
  x <span class='op'>=</span> <span class='va'>y</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for stlm</span>
<span class='fu'><a href='forecast.html'>forecast</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  h <span class='op'>=</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>object</span><span class='op'>$</span><span class='va'>m</span>,
  level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>95</span><span class='op'>)</span>,
  fan <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lambda <span class='op'>=</span> <span class='va'>object</span><span class='op'>$</span><span class='va'>lambda</span>,
  biasadj <span class='op'>=</span> <span class='cn'>NULL</span>,
  newxreg <span class='op'>=</span> <span class='cn'>NULL</span>,
  allow.multiplicative.trend <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>stlf</span><span class='op'>(</span>
  <span class='va'>y</span>,
  h <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/time.html'>frequency</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span>,
  s.window <span class='op'>=</span> <span class='fl'>7</span> <span class='op'>+</span> <span class='fl'>4</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>,
  t.window <span class='op'>=</span> <span class='cn'>NULL</span>,
  robust <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lambda <span class='op'>=</span> <span class='cn'>NULL</span>,
  biasadj <span class='op'>=</span> <span class='cn'>FALSE</span>,
  x <span class='op'>=</span> <span class='va'>y</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>stl</code> or <code>stlm</code>. Usually the
result of a call to <code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code> or <code>stlm</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method to use for forecasting the seasonally adjusted series.</p></td>
    </tr>
    <tr>
      <th>etsmodel</th>
      <td><p>The ets model specification passed to
<code><a href='ets.html'>ets</a></code>. By default it allows any non-seasonal model. If
<code>method!="ets"</code>, this argument is ignored.</p></td>
    </tr>
    <tr>
      <th>forecastfunction</th>
      <td><p>An alternative way of specifying the function for
forecasting the seasonally adjusted series. If <code>forecastfunction</code> is
not <code>NULL</code>, then <code>method</code> is ignored. Otherwise <code>method</code> is
used to specify the forecasting method to be used.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Number of periods for forecasting.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Confidence level for prediction intervals.</p></td>
    </tr>
    <tr>
      <th>fan</th>
      <td><p>If <code>TRUE</code>, level is set to seq(51,99,by=3). This is suitable
for fan plots.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Box-Cox transformation parameter. If <code>lambda="auto"</code>,
then a transformation is automatically selected using <code>BoxCox.lambda</code>.
The transformation is ignored if NULL. Otherwise,
data transformed before model is estimated.</p></td>
    </tr>
    <tr>
      <th>biasadj</th>
      <td><p>Use adjusted back-transformed mean for Box-Cox
transformations. If transformed data is used to produce forecasts and fitted values,
a regular back transformation will result in median forecasts. If biasadj is TRUE,
an adjustment will be made to produce mean forecasts and fitted values.</p></td>
    </tr>
    <tr>
      <th>xreg</th>
      <td><p>Historical regressors to be used in
<code><a href='auto.arima.html'>auto.arima</a>()</code> when <code>method=="arima"</code>.</p></td>
    </tr>
    <tr>
      <th>newxreg</th>
      <td><p>Future regressors to be used in
<code><a href='forecast.fracdiff.html'>forecast.Arima</a>()</code>.</p></td>
    </tr>
    <tr>
      <th>allow.multiplicative.trend</th>
      <td><p>If TRUE, then ETS models with
multiplicative trends are allowed. Otherwise, only additive or no trend ETS
models are permitted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to <code>forecast.stl</code>,
<code>modelfunction</code> or <code>forecastfunction</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A univariate numeric time series of class <code>ts</code></p></td>
    </tr>
    <tr>
      <th>s.window</th>
      <td><p>Either the character string ``periodic'' or the span (in
lags) of the loess window for seasonal extraction.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>If <code>TRUE</code>, robust fitting will used in the loess
procedure within <code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code>.</p></td>
    </tr>
    <tr>
      <th>modelfunction</th>
      <td><p>An alternative way of specifying the function for
modelling the seasonally adjusted series. If <code>modelfunction</code> is not
<code>NULL</code>, then <code>method</code> is ignored. Otherwise <code>method</code> is used
to specify the time series model to be used.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Output from a previous call to <code>stlm</code>. If a <code>stlm</code>
model is passed, this same model is fitted to y without re-estimating any
parameters.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Deprecated. Included for backwards compatibility.</p></td>
    </tr>
    <tr>
      <th>t.window</th>
      <td><p>A number to control the smoothness of the trend. See
<code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code> for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>stlm</code> returns an object of class <code>stlm</code>. The other
functions return objects of class <code>forecast</code>.</p>
<p>There are many methods for working with <code><a href='forecast.html'>forecast</a></code> objects
including <code>summary</code> to obtain and print a summary of the results, while
<code>plot</code> produces a plot of the forecasts and prediction intervals. The
generic accessor functions <code>fitted.values</code> and <code>residuals</code> extract
useful features.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>stlm</code> takes a time series <code>y</code>, applies an STL decomposition, and
models the seasonally adjusted data using the model passed as
<code>modelfunction</code> or specified using <code>method</code>. It returns an object
that includes the original STL decomposition and a time series model fitted
to the seasonally adjusted data. This object can be passed to the
<code>forecast.stlm</code> for forecasting.</p>
<p><code>forecast.stlm</code> forecasts the seasonally adjusted data, then
re-seasonalizes the results by adding back the last year of the estimated
seasonal component.</p>
<p><code>stlf</code> combines <code>stlm</code> and <code>forecast.stlm</code>. It takes a
<code>ts</code> argument, applies an STL decomposition, models the seasonally
adjusted data, reseasonalizes, and returns the forecasts. However, it allows
more general forecasting methods to be specified via
<code>forecastfunction</code>.</p>
<p><code>forecast.stl</code> is similar to <code>stlf</code> except that it takes the STL
decomposition as the first argument, instead of the time series.</p>
<p>Note that the prediction intervals ignore the uncertainty associated with
the seasonal component. They are computed using the prediction intervals
from the seasonally adjusted series, which are then reseasonalized using the
last year of the seasonal component. The uncertainty in the seasonal
component is ignored.</p>
<p>The time series model for the seasonally adjusted data can be specified in
<code>stlm</code> using either <code>method</code> or <code>modelfunction</code>. The
<code>method</code> argument provides a shorthand way of specifying
<code>modelfunction</code> for a few special cases. More generally,
<code>modelfunction</code> can be any function with first argument a <code>ts</code>
object, that returns an object that can be passed to <code><a href='forecast.html'>forecast</a></code>.
For example, <code>forecastfunction=ar</code> uses the <code><a href='https://rdrr.io/r/stats/ar.html'>ar</a></code> function
for modelling the seasonally adjusted series.</p>
<p>The forecasting method for the seasonally adjusted data can be specified in
<code>stlf</code> and <code>forecast.stl</code> using either <code>method</code> or
<code>forecastfunction</code>. The <code>method</code> argument provides a shorthand way
of specifying <code>forecastfunction</code> for a few special cases. More
generally, <code>forecastfunction</code> can be any function with first argument a
<code>ts</code> object, and other <code>h</code> and <code>level</code>, which returns an
object of class <code><a href='forecast.html'>forecast</a></code>. For example,
<code>forecastfunction=thetaf</code> uses the <code><a href='thetaf.html'>thetaf</a></code> function for
forecasting the seasonally adjusted series.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code>, <code><a href='forecast.ets.html'>forecast.ets</a></code>,
<code><a href='forecast.fracdiff.html'>forecast.Arima</a></code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Rob J Hyndman</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='va'>tsmod</span> <span class='op'>&lt;-</span> <span class='fu'>stlm</span><span class='op'>(</span><span class='va'>USAccDeaths</span>, modelfunction <span class='op'>=</span> <span class='va'>ar</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='forecast.html'>forecast</a></span><span class='op'>(</span><span class='va'>tsmod</span>, h <span class='op'>=</span> <span class='fl'>36</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='forecast.stl-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>decomp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/stl.html'>stl</a></span><span class='op'>(</span><span class='va'>USAccDeaths</span>, s.window <span class='op'>=</span> <span class='st'>"periodic"</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='forecast.html'>forecast</a></span><span class='op'>(</span><span class='va'>decomp</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='forecast.stl-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>stlf</span><span class='op'>(</span><span class='va'>AirPassengers</span>, lambda <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='forecast.stl-3.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://robjhyndman.com'>Rob Hyndman</a>, George Athanasopoulos, <a href='https://github.com/cbergmeir'>Christoph Bergmeir</a>, <a href='https://github.com/gabrielcaceres'>Gabriel Caceres</a>, Leanne Chhay, <a href='https://github.com/mitchelloharawild'>Mitchell O'Hara-Wild</a>, <a href='http://fpetropoulos.eu'>Fotios Petropoulos</a>, <a href='https://github.com/slavarazbash'>Slava Razbash</a>, <a href='http://earo.me'>Earo Wang</a>, Farah Yasmeen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


